// ═══════════════════════════════════════════════════════════════════════════════
// WAHRHEITSPRÜFUNG - Nur was WAHR ist, darf bestehen!
// ═══════════════════════════════════════════════════════════════════════════════

#include <iostream>
#include <iomanip>
#include <cmath>
#include <vector>
#include <string>
#include "rael/rst_constants.hpp"

using namespace rael::rst;

int passed = 0, failed = 0;

void test(const std::string& name, double erwartet, double berechnet, double tol = 1e-9) {
    bool ok = std::abs(erwartet - berechnet) < tol;
    if (ok) {
        std::cout << "  ✓ " << name << "\n";
        passed++;
    } else {
        std::cout << "  ✗ " << name << " (erwartet: " << erwartet << ", bekommen: " << berechnet << ")\n";
        failed++;
    }
}

int main() {
    std::cout << std::fixed << std::setprecision(10);
    
    std::cout << "╔═══════════════════════════════════════════════════════════════════╗\n";
    std::cout << "║        WAHRHEITSPRÜFUNG - NUR WAHRES DARF BESTEHEN               ║\n";
    std::cout << "╚═══════════════════════════════════════════════════════════════════╝\n\n";

    // ═══════════════════════════════════════════════════════════════════
    std::cout << "=== GRUNDKONSTANTEN ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("G0 = 8/9", 8.0/9.0, G0);
    test("G1 = 5/9", 5.0/9.0, G1);
    test("G3 = 3/9 = 1/3", 1.0/3.0, G3);
    test("G5 = 1/9", 1.0/9.0, G5);
    test("SIGNATURE_88 = 88", 88.0, SIGNATURE_88);
    test("G0 + G5 = 1", 1.0, G0 + G5);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== PHI_FILE (13/17 × 88) ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("PHI_FILE = (13/17) × 88", (13.0/17.0) * 88.0, PHI_FILE);
    test("13/17 = sqrt(169/289)", 13.0/17.0, std::sqrt(169.0/289.0));
    test("PHI_FILE ≈ 67.29", 67.294117647, PHI_FILE, 0.0001);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== SIGNATUR-VEREINIGUNG (V48 Erkenntnis) ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("SIG_UNIFIED = 800/9", 800.0/9.0, SIG_UNIFIED);
    test("800/9 = 88 + 8/9", 88.0 + 8.0/9.0, SIG_UNIFIED);
    test("800/9 ≈ 88.888...", 88.888888888889, SIG_UNIFIED, 0.0001);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== BEWUSSTSEINS-ENERGIE (K_A) ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("K_A = G0/9", G0/9.0, K_A_CONST);
    test("a²(1,1,1) = K_A × 9 = G0", G0, a_quadrat(1.0, 1.0, 1.0));
    test("a²(0,0,0) = 0", 0.0, a_quadrat(0.0, 0.0, 0.0));
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== TUNNEL-KONSTANTEN ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("TUNNEL_LICHT = 144", 144.0, TUNNEL_LICHT);
    test("TUNNEL_KERN = 13", 13.0, TUNNEL_KERN);
    test("144 = 8×17 + 8 (Base-17: 88)", 144.0, 8.0*17.0 + 8.0);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== SOLITON-PEAK ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    // sech²(0) = 1, also Peak = SIG × G0
    double peak_88 = SIGNATURE_88 * G0;  // 78.222...
    double peak_unified = SIG_UNIFIED * G0;  // 79.012...
    
    test("Peak(88) = 88 × G0 = 78.222...", 78.222222222, peak_88, 0.0001);
    test("Peak(800/9) = 79.012...", 79.012345679, peak_unified, 0.0001);
    test("soliton_peak_unified(0)", peak_unified, soliton_peak_unified(0.0), 0.0001);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== KAEL-SCHILD (53 Hz) ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("53 + 35 = 88 (Spiegel)", 88.0, 53.0 + 35.0);
    test("kael_schild(1, 53) = Maximum", 1.0, kael_schild(1.0, 53.0));
    // Bei 53 Hz exakt: resonanz = 1/(1+0) = 1
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== MATRIX-BEZIEHUNGEN ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("17×17 = 289", 289.0, 17.0*17.0);
    test("13×13 = 169", 169.0, 13.0*13.0);
    test("289 - 169 = 120 = 5!", 120.0, 289.0 - 169.0);
    test("5! = 120", 120.0, 1.0*2.0*3.0*4.0*5.0);
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== MASTER-CHECKS ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("sigma_54_tunnel() = G0", G0, sigma_54_tunnel());
    test("sigma_55_block() = G0", G0, sigma_55_block());
    
    // ═══════════════════════════════════════════════════════════════════
    std::cout << "\n=== AETHER-SÄTTIGUNG ===\n";
    // ═══════════════════════════════════════════════════════════════════
    
    test("AETHER_SAT = 88 × G0 × PHI", SIGNATURE_88 * G0 * PHI, AETHER_SAT, 0.001);
    
    // ═══════════════════════════════════════════════════════════════════
    // ZUSAMMENFASSUNG
    // ═══════════════════════════════════════════════════════════════════
    
    std::cout << "\n╔═══════════════════════════════════════════════════════════════════╗\n";
    std::cout << "║                         ERGEBNIS                                   ║\n";
    std::cout << "╠═══════════════════════════════════════════════════════════════════╣\n";
    std::cout << "║  BESTANDEN: " << std::setw(3) << passed << "                                                  ║\n";
    std::cout << "║  GEFALLEN:  " << std::setw(3) << failed << "                                                  ║\n";
    std::cout << "╚═══════════════════════════════════════════════════════════════════╝\n";
    
    if (failed > 0) {
        std::cout << "\n⚠️  " << failed << " FORMELN SIND FALSCH!\n";
        return 1;
    } else {
        std::cout << "\n✓ ALLE FORMELN SIND WAHR!\n";
        return 0;
    }
}
